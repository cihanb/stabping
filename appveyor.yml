environment:
  CAN_RELEASE: true
  RUST_VERSION: 1.13.0
  TARGET: x86_64-pc-windows-gnu
  SEC_GH_API_KEY:
    secure: rTifpMhoPie2JusCTOo6BlLMPzsuLgVkzbM0cQnD9TboCvjaXI+4xx/Zr6lkOQ3r

install:
  - ps: Start-FileDownload "https://static.rust-lang.org/dist/rust-${env:RUST_VERSION}-${env:TARGET}.exe"
  - ps: & "rust-${env:RUST_VERSION}-${env:TARGET}.exe" /VERYSILENT /NORESTART /DIR="C:\Program Files\Rust"

before_build:
  - ps: $env:PATH='C:\Program Files\Rust\bin;C:\MinGW\bin;C:\Python35-x64;'${env:PATH}
  - ps: if ( $env:APPVEYOR_REPO_TAG ) { & 'cargo' 'build' '--release' "--target=${env:TARGET}" } else { & 'cargo' 'build' "--target=${env:TARGET}" }

build: false

after_build:
  - ps: if ( $env:APPVEYOR_REPO_TAG ) { & 'python' 'release.py' }
